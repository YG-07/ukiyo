import{d as oe,r as u,k as ne,j as le,U as s,o as a,V as l,W as t,X as o,b as W,e as N,$ as P,P as e,z as j,v as I,Y as i,c as C,N as K,F as M,a4 as ue,a0 as se,a2 as ie}from"./@vue-5600d395.js";import{P as re}from"./PicCard-4ded919e.js";import{c as pe,a as ce,d as me,q as _e}from"./index-14828061.js";import{U as de}from"./UrlSelect-ec9f5796.js";import{A as ye}from"./@vicons-c53b9e6c.js";import{e as ve,u as he}from"./naive-ui-ae92ea56.js";import"./plugin-vueexport-helper-d7c00f7c.js";import"./lodash-7b9fd68c.js";import"./date-fns-d101b321.js";import"./moment-b35f754a.js";import"./mitt-dab1f1cb.js";import"./css-render-99fcc978.js";import"./@emotion-e1dc9e92.js";import"./@css-render-5e321065.js";import"./seemly-ab171afc.js";import"./lodash-es-882891f9.js";import"./vooks-d8282700.js";import"./evtd-3bd1ff11.js";import"./vueuc-e5d9b751.js";import"./vdirs-c82cf9c8.js";import"./@juggle-d50e7493.js";import"./treemate-97ea80b9.js";import"./date-fns-tz-94aca45e.js";import"./async-validator-9e2b95c0.js";const fe=W("h2",null,"\u5929\u8D4B\u4E66",-1),ke=N("\u641C\u7D22"),ge=N("\u91CD\u7F6E\u6761\u4EF6"),Xe=oe({__name:"Book",setup(we){const h=u(pe()),m=u(!1),U=ve(),G=he();let d=u(!0),z=u(""),B=u(-2),E=u(-2),F=u(-2),g=u({pageNum:1,pageSize:100}),S=u(0),w=u([]),f=u(`
    ${h.value?"margin: 20px;":"margin:2px;"}
    display: flex;
    justify-content: center;
    flex-wrap: wrap;
  `);const X=n=>{B.value=n,y(1)},Y=n=>{E.value=n,y(1)},H=n=>{F.value=n,y(1)},J=n=>{z.value=n},O=n=>{y(1)},Q=()=>{z.value="",B.value=-2,y(1)},Z=n=>{g.value.pageSize=n,y(1)};u({});const b=u({}),R=async()=>{U.start(),m.value=!0;let n={name:z.value,star:B.value,week:F.value,book:E.value,page:g.value},{code:k,data:r,msg:$}=await me(n);if(k!=200){G.error($),setTimeout(()=>{U.finish()},500),m.value=!1;return}S.value=r.total;const{mhy_base:D,mhy_url:p,wiki_base:x,wiki_book_item:L}=await _e(),A=`${D}${p}`,V=`${x}${L}`;w.value=r==null?void 0:r.records.map(_=>(_.mhy_url=A.replace("{id}",_.mhy_url),_.wiki_url=V.replace("{id}",_.wiki_url),_.imgSrc=_.icon_url,_)),setTimeout(()=>{U.finish()},500),m.value=!1},y=async n=>{g.value.pageNum=n,w.value=[],S.value=0,R()};return ne(async()=>{b.value=await ce()}),le(()=>{R()}),(n,k)=>{const r=s("n-skeleton"),$=s("n-gradient-text"),D=s("n-layout-header"),p=s("n-space"),x=s("n-select"),L=s("n-input"),A=s("n-button"),V=s("n-divider"),_=s("n-icon"),ee=s("n-empty"),te=s("n-layout-content"),ae=s("n-pagination"),q=s("n-layout");return a(),l(q,null,{default:t(()=>[o(D,{class:"header-top"},{default:t(()=>[W("div",null,[fe,m.value?(a(),l(r,{key:0,width:150,sharp:!1,size:"medium"})):(a(),l($,{key:1,gradient:{from:"rgb(85, 85, 85)",to:"rgb(170, 170, 170)"}},{default:t(()=>[N(" \u5171"+P(e(S))+"\u4E2A\uFF0C\u5DF2\u5C55\u793A"+P(e(w).length)+"\u4E2A ",1)]),_:1},8,["gradient"]))]),m.value?(a(),l(r,{key:0,width:300,sharp:!1,size:"medium"})):(a(),l(de,{key:1}))]),_:1}),o(q,null,{default:t(()=>[o(D,null,{default:t(()=>[m.value?j((a(),l(p,{key:0,style:i(e(f))},{default:t(()=>[(a(!0),C(M,null,K(new Array(8),(c,v)=>(a(),l(r,{key:v,width:200,sharp:!1,size:"medium"}))),128))]),_:1},8,["style"])),[[I,e(d)]]):j((a(),l(p,{key:1,class:"space-main",style:i(e(f))},{default:t(()=>{var c,v,T;return[o(x,{value:e(B),"onUpdate:value":X,options:(c=b.value)==null?void 0:c.star,style:i(h.value?"width: 200px":"")},null,8,["value","options","style"]),o(x,{value:e(F),"onUpdate:value":H,options:(v=b.value)==null?void 0:v.week,style:i(h.value?"width: 200px":"")},null,8,["value","options","style"]),o(x,{value:e(E),"onUpdate:value":Y,options:(T=b.value)==null?void 0:T.book,style:i(h.value?"width: 200px":"")},null,8,["value","options","style"]),o(L,{value:e(z),onKeyup:ue(O,["enter"]),"onUpdate:value":J,type:"text",placeholder:"\u641C\u7D22\u5929\u8D4B\u4E66\u540D",style:i(h.value?"width: 200px":"min-width: 200px;")},null,8,["value","onKeyup","style"]),o(p,{style:i(h.value?"flex:1;":"min-width: 200px;")},{default:t(()=>[o(A,{type:"success",style:{width:"84px"},onClick:k[0]||(k[0]=xe=>y(1))},{default:t(()=>[ke]),_:1}),o(A,{type:"warning",onClick:Q},{default:t(()=>[ge]),_:1})]),_:1},8,["style"])]}),_:1},8,["style"])),[[I,e(d)]]),h.value?ie("",!0):(a(),l(V,{key:2,onClick:k[1]||(k[1]=c=>se(d)?d.value=!e(d):d=!e(d))},{default:t(()=>[N(P(e(d)?"\u6536\u8D77\u641C\u7D22":"\u5C55\u5F00\u641C\u7D22"),1)]),_:1}))]),_:1}),o(te,{"has-sider":""},{default:t(()=>[m.value?(a(),l(p,{key:0,style:i(e(f))},{default:t(()=>[(a(!0),C(M,null,K(new Array(20),(c,v)=>(a(),C("div",{key:v},[o(r,{width:100,height:123,sharp:!1,size:"medium"})]))),128))]),_:1},8,["style"])):!m.value&&e(w).length>0?(a(),l(p,{key:1,style:i(e(f))},{default:t(()=>[(a(!0),C(M,null,K(e(w),(c,v)=>(a(),C("div",{key:v},[o(re,{round:"0.75rem",src:c.imgSrc,item:c,mhy_url:c.mhy_url,wiki_url:c.wiki_url},null,8,["src","item","mhy_url","wiki_url"])]))),128))]),_:1},8,["style"])):(a(),l(p,{key:2,style:i([{width:"100%"},e(f)])},{default:t(()=>[o(ee,{description:"\u6240\u9009\u6761\u4EF6\u7684\u6570\u636E\u4E3A\u7A7A"},{icon:t(()=>[o(_,null,{default:t(()=>[o(e(ye))]),_:1})]),_:1})]),_:1},8,["style"]))]),_:1}),o(q,{"content-style":"overflow-x: scroll;"},{default:t(()=>[m.value?(a(),l(p,{key:0,style:i(e(f))},{default:t(()=>[o(r,{width:300,sharp:!1,size:"medium"})]),_:1},8,["style"])):(a(),l(p,{key:1,style:i(e(f))},{default:t(()=>[o(ae,{page:e(g).pageNum,"page-size":e(g).pageSize,"item-count":e(S),"on-update:page":y,"show-size-picker":"","page-sizes":[10,50,70,100],"on-update:page-size":Z},null,8,["page","page-size","item-count"])]),_:1},8,["style"]))]),_:1})]),_:1})]),_:1})}}});export{Xe as default};
